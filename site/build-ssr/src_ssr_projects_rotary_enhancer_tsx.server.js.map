{"version":3,"file":"src_ssr_projects_rotary_enhancer_tsx.server.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAC4C;AACH;AACmB;AACK;AACJ;AAAA;AAE9C,SAASQ,cAAcA,CAAA,EAAG;EACvC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGT,+CAAQ,CAAqB,IAAI,CAAC;EAC1D,MAAM,CAACU,KAAK,EAAEC,QAAQ,CAAC,GAAGX,+CAAQ,CAAC,MAAOY,MAAM,CAACC,UAAU,GAAG,GAAG,GAAG,EAAE,GAAG,EAAG,CAAC;EAC7E,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGf,+CAAQ,CAACY,MAAM,CAACI,WAAW,GAAGJ,MAAM,CAACC,UAAU,CAAC;EAEpFV,0EAAc,CAAC,CAAC;EAEhBJ,gDAAS,CAAC,MAAM;IACd;IACAkB,QAAQ,CAACC,cAAc,CAAC,YAAY,CAAC,EAAEC,SAAS,CAACC,MAAM,CAAC,mBAAmB,CAAC;;IAE5E;IACA;IACA,MAAMC,MAAM,GAAGJ,QAAQ,CAACK,aAAa,CAAC,6BAA6B,CAA4B;IAC/F,MAAMC,MAAM,GAAGN,QAAQ,CAACK,aAAa,CAAC,6BAA6B,CAA4B;IAE/F,MAAME,KAAK,GAAGH,MAAM,EAAEI,OAAO,EAAEC,OAAO;IACtC,MAAMC,KAAK,GAAGJ,MAAM,EAAEE,OAAO,EAAEC,OAAO;IAEtC,IAAIL,MAAM,IAAIG,KAAK,IAAIH,MAAM,CAACO,GAAG,KAAKJ,KAAK,EAAEH,MAAM,CAACO,GAAG,GAAGJ,KAAK;IAC/D,IAAID,MAAM,IAAII,KAAK,IAAIJ,MAAM,CAACK,GAAG,KAAKD,KAAK,EAAEJ,MAAM,CAACK,GAAG,GAAGD,KAAK;;IAE/D;IACAlB,OAAO,CAACQ,QAAQ,CAACC,cAAc,CAAC,uBAAuB,CAAC,CAAC;;IAEzD;IACAd,yEAAe,CAACM,KAAK,EAAEI,UAAU,EAAE;MACjCe,EAAE,EAAE,0BAA0B;MAC9BC,EAAE,EAAE;IACN,CAAC,CAAC;;IAEF;IACA,MAAMC,QAAQ,GAAGA,CAAA,KAAM;MACrB,MAAMC,CAAC,GAAGpB,MAAM,CAACI,WAAW,GAAGJ,MAAM,CAACC,UAAU;MAChDE,aAAa,CAACiB,CAAC,CAAC;MAChB;MACA5B,yEAAe,CAACM,KAAK,EAAEsB,CAAC,EAAE;QACxBH,EAAE,EAAE,0BAA0B;QAC9BC,EAAE,EAAE;MACN,CAAC,CAAC;IACJ,CAAC;IACDlB,MAAM,CAACqB,gBAAgB,CAAC,QAAQ,EAAEF,QAAQ,EAAE;MAAEG,OAAO,EAAE;IAAK,CAAC,CAAC;IAC9D,OAAO,MAAMtB,MAAM,CAACuB,mBAAmB,CAAC,QAAQ,EAAEJ,QAAQ,CAAC;EAC7D,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAER;EACAhC,gDAAS,CAAC,MAAM;IACdK,yEAAe,CAACM,KAAK,EAAEI,UAAU,EAAE;MACjCe,EAAE,EAAE,0BAA0B;MAC9BC,EAAE,EAAE;IACN,CAAC,CAAC;EACJ,CAAC,EAAE,CAACpB,KAAK,EAAEI,UAAU,CAAC,CAAC;EAEvB,IAAI,CAACN,IAAI,EAAE,OAAO,IAAI;EACpB,oBAAOP,uDAAY,CACjBK,+DAAA,CAACJ,+DAAgB;IACfQ,KAAK,EAAEA,KAAM;IACbC,QAAQ,EAAEA,QAAS;IACnByB,GAAG,EAAE;MAAEP,EAAE,EAAE,0BAA0B;MAAEC,EAAE,EAAE;IAA2B;EAAE,CACzE,CAAC,EACFtB,IACJ,CAAC;AACH,C","sources":["webpack://personal-site/./src/ssr/projects/rotary.enhancer.tsx"],"sourcesContent":["// RotaryEnhancer.tsx\r\nimport { useEffect, useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport SplitDragHandler from '../../utils/split-controller';\r\nimport { useTooltipInit } from '../../utils/tooltip/tooltipInit';\r\nimport { applySplitStyle } from '../logic/apply-split-style';\r\n\r\nexport default function RotaryEnhancer() {\r\n  const [host, setHost] = useState<HTMLElement | null>(null);\r\n  const [split, setSplit] = useState(() => (window.innerWidth < 768 ? 55 : 50));\r\n  const [isPortrait, setIsPortrait] = useState(window.innerHeight > window.innerWidth);\r\n\r\n  useTooltipInit();\r\n\r\n  useEffect(() => {\r\n    // Remove SSR preset so JS can control layout without specificity fights\r\n    document.getElementById('rotary-ssr')?.classList.remove('ssr-initial-split');\r\n\r\n    // Upgrade images from SSR medium-quality to high-quality (if provided)\r\n    // Upgrade images/videos from SSR medium-quality to high-quality (if provided)\r\n    const img1El = document.querySelector('#rotary-ssr #rotary-media-1') as HTMLImageElement | null;\r\n    const img2El = document.querySelector('#rotary-ssr #rotary-media-2') as HTMLVideoElement | null;\r\n\r\n    const full1 = img1El?.dataset?.srcFull;\r\n    const full2 = img2El?.dataset?.srcFull;\r\n\r\n    if (img1El && full1 && img1El.src !== full1) img1El.src = full1;\r\n    if (img2El && full2 && img2El.src !== full2) img2El.src = full2;\r\n\r\n    // Set mount host\r\n    setHost(document.getElementById('rotary-enhancer-mount'));\r\n\r\n    // Initial apply to exactly mirror non-SSR logic on hydration\r\n    applySplitStyle(split, isPortrait, {\r\n      m1: 'rotary-media-1-container',\r\n      m2: 'rotary-media-2-container',\r\n    });\r\n\r\n    // Orientation listener\r\n    const onResize = () => {\r\n      const p = window.innerHeight > window.innerWidth;\r\n      setIsPortrait(p);\r\n      // Re-apply immediately on orientation change\r\n      applySplitStyle(split, p, {\r\n        m1: 'rotary-media-1-container',\r\n        m2: 'rotary-media-2-container',\r\n      });\r\n    };\r\n    window.addEventListener('resize', onResize, { passive: true });\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []); // run once\r\n\r\n  // Keep DOM in sync when split OR orientation changes\r\n  useEffect(() => {\r\n    applySplitStyle(split, isPortrait, {\r\n      m1: 'rotary-media-1-container',\r\n      m2: 'rotary-media-2-container',\r\n    });\r\n  }, [split, isPortrait]);\r\n\r\n  if (!host) return null;\r\n    return createPortal(\r\n      <SplitDragHandler\r\n        split={split}\r\n        setSplit={setSplit}\r\n        ids={{ m1: 'rotary-media-1-container', m2: 'rotary-media-2-container' }}\r\n      />,\r\n      host\r\n  );\r\n}\r\n"],"names":["useEffect","useState","createPortal","SplitDragHandler","useTooltipInit","applySplitStyle","jsx","_jsx","RotaryEnhancer","host","setHost","split","setSplit","window","innerWidth","isPortrait","setIsPortrait","innerHeight","document","getElementById","classList","remove","img1El","querySelector","img2El","full1","dataset","srcFull","full2","src","m1","m2","onResize","p","addEventListener","passive","removeEventListener","ids"],"sourceRoot":""}