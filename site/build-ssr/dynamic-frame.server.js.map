{"version":3,"file":"dynamic-frame.server.js","mappings":"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","sources":["webpack://personal-site/./src/components/dynamic-app/frame.tsx","webpack://personal-site/./src/dynamic-app/lib/fetchSVGIcons.js","webpack://personal-site/./src/dynamic-app/lib/fetchUser.js","webpack://personal-site/./src/dynamic-app/preload-dynamic-app.ts","webpack://personal-site/./src/styles/block-type-a.css","webpack://personal-site/./src/styles/loading-hub.css","webpack://personal-site/./src/utils/content-utility/dynamic-overlay.ts","webpack://personal-site/./src/utils/content-utility/real-mobile.ts","webpack://personal-site/./src/utils/loading/loading-hub.tsx"],"sourcesContent":["// src/components/dynamic-app/frame.tsx\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport client from '../../utils/sanity';\r\nimport { useDynamicOverlay } from '../../utils/content-utility/dynamic-overlay';\r\nimport { useSsrData } from '../../utils/context-providers/ssr-data-context';\r\nimport { useRealMobileViewport } from '../../utils/content-utility/real-mobile';\r\nimport LoadingHub from '../../utils/loading/loading-hub';\r\nimport '../../styles/block-type-a.css';\r\n\r\nimport { ensureDynamicPreload } from '../../dynamic-app/preload-dynamic-app';\r\nimport { urlFor } from '../../utils/media-providers/image-builder';\r\n\r\nconst getDeviceType = (w: number): 'phone' | 'tablet' | 'laptop' =>\r\n  w < 768 ? 'phone' : w < 1025 ? 'tablet' : 'laptop';\r\n\r\nconst Frame: React.FC = () => {\r\n  const ssrData = useSsrData();\r\n  const preloadedMap = (ssrData?.preloaded?.dynamic as Record<string, string>) || {};\r\n  const [svgMap, setSvgMap] = useState<Record<string, string>>(preloadedMap);\r\n  const [device, setDevice] = useState<'phone' | 'tablet' | 'laptop'>(\r\n    getDeviceType(typeof window !== 'undefined' ? window.innerWidth : 1200)\r\n  );\r\n  const [imgLoaded, setImgLoaded] = useState(false);\r\n  const [fetchErr, setFetchErr] = useState<string | null>(null);\r\n\r\n  const frameRef = useRef<HTMLImageElement>(null);\r\n  const overlaySize = useDynamicOverlay(frameRef);\r\n  const isRealMobile = useRealMobileViewport();\r\n\r\n  useEffect(() => {\r\n    const onResize = () => setDevice(getDeviceType(window.innerWidth));\r\n    window.addEventListener('resize', onResize);\r\n    window.addEventListener('orientationchange', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n      window.removeEventListener('orientationchange', onResize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(svgMap).length > 0) return;\r\n    client\r\n      .fetch(\r\n        `*[_type == \"svgAsset\" && title in [\"Laptop\", \"Tablet\", \"Phone\"]]{\r\n          title, file { asset->{url} }\r\n        }`\r\n      )\r\n      .then((results: any[]) => {\r\n        const map: Record<string, string> = {};\r\n        results.forEach((r: any) => {\r\n          map[r.title.toLowerCase()] = r.file?.asset?.url;\r\n        });\r\n        setSvgMap(map);\r\n      })\r\n      .catch((err) => {\r\n        setFetchErr('assets-unavailable');\r\n        console.warn('[Frame] fetch SVG failed:', err);\r\n      });\r\n  }, [svgMap]);\r\n\r\n  const svgUrl = svgMap[device];\r\n\r\n  useEffect(() => {\r\n    const img = frameRef.current;\r\n    setImgLoaded(Boolean(img && img.complete && svgUrl));\r\n  }, [svgUrl]);\r\n\r\n  // When the frame is in place, warm LOW-QUALITY card images into cache\r\n  const warmedOnce = useRef(false);\r\n  useEffect(() => {\r\n    if (!imgLoaded || warmedOnce.current) return;\r\n    warmedOnce.current = true;\r\n\r\n    (async () => {\r\n      try {\r\n        const { images } = await ensureDynamicPreload(); // deduped with any other callers\r\n        if (!Array.isArray(images) || images.length === 0) return;\r\n\r\n        // tune these to taste\r\n        const WARM_COUNT = 16;     // how many items to warm\r\n        const LQ_WIDTH = 320;      // low-quality width\r\n        const LQ_QUALITY = 25;     // low-quality JPEG/WebP quality\r\n\r\n        const head = document.head;\r\n        let warmed = 0;\r\n\r\n        outer: for (const it of images) {\r\n          // warm both image1 and image2 if present, but respect WARM_COUNT cap\r\n          const candidates = [it?.image1, it?.image2].filter(Boolean);\r\n          for (const srcAsset of candidates) {\r\n            const src = urlFor(srcAsset)\r\n              .width(LQ_WIDTH)\r\n              .quality(LQ_QUALITY)\r\n              .auto('format')\r\n              .url();\r\n\r\n            if (!src) continue;\r\n\r\n            // Avoid duplicate <link> entries\r\n            if (!document.querySelector(`link[rel=\"preload\"][as=\"image\"][href=\"${src}\"]`)) {\r\n              const link = document.createElement('link');\r\n              link.rel = 'preload';\r\n              link.as = 'image';\r\n              link.href = src;\r\n              link.crossOrigin = 'anonymous';\r\n              // TS-safe way to set fetch priority hint\r\n              link.setAttribute('fetchpriority', 'low');\r\n              head.appendChild(link);\r\n            }\r\n\r\n            // Kick off an actual request regardless of preload support\r\n            const preImg = new Image();\r\n            preImg.decoding = 'async';\r\n            preImg.crossOrigin = 'anonymous';\r\n            preImg.src = src;\r\n\r\n            warmed += 1;\r\n            if (warmed >= WARM_COUNT) break outer;\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore; cards will still lazy-load normally\r\n      }\r\n    })();\r\n  }, [imgLoaded]);\r\n\r\n  return (\r\n    <section className=\"block-type-a\">\r\n      <div className=\"device-wrapper\">\r\n        <img\r\n          ref={frameRef}\r\n          id=\"dynamic-device-frame\"\r\n          src={svgUrl || undefined}\r\n          alt={device}\r\n          className={`device-frame ${device}`}\r\n          decoding=\"async\"\r\n          loading=\"eager\"\r\n          onLoad={() => setImgLoaded(true)}\r\n          onError={() => setImgLoaded(true)}\r\n          draggable={false}\r\n          style={{\r\n            visibility: svgUrl ? 'visible' : 'hidden',\r\n            opacity: imgLoaded && svgUrl ? 1 : 0,\r\n            transition: 'opacity 150ms ease',\r\n          }}\r\n          data-src-laptop={svgMap['laptop'] || ''}\r\n          data-src-tablet={svgMap['tablet'] || ''}\r\n          data-src-phone={svgMap['phone'] || ''}\r\n          data-device={device}\r\n        />\r\n\r\n        <div\r\n          className=\"screen-overlay\"\r\n          style={\r\n            device === 'phone'\r\n              ? {\r\n                  width: `${overlaySize.width}px`,\r\n                  height: isRealMobile\r\n                    ? `${overlaySize.heightSet1}svh`\r\n                    : `${overlaySize.heightSet2}px`,\r\n                }\r\n              : undefined\r\n          }\r\n        >\r\n          {/* Loader hub goes here. ShadowEntry will hide it onReady */}\r\n          <div id=\"dynamic-overlay-loader\">\r\n            <LoadingHub\r\n              className=\"loading-hub--dynamic loading-hub--center\"\r\n              keyword=\"dynamic\"\r\n              lines={[\r\n                'Measuring app frame…',\r\n                'Creating shadow root…',\r\n                'Injecting app styles…',\r\n                'Loading SVG icons…',\r\n                'Mounting app shell…',\r\n                'Wiring observers and input…',\r\n              ]}\r\n              minHeight={72}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {fetchErr && <div className=\"soft-warning\">media frame unavailable</div>}\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Frame;\r\n","/* Fetch SVG icons */\r\nimport sanityClient from '../../utils/sanity';\r\n\r\nexport default async function fetchSVGIcons() {\r\n  const query = `*[_type == \"svgIcon\"]{\r\n    title,\r\n    icon,                         // inline SVG string (portable text / string)\r\n    \"url\": file.asset->url        // optional file URL if present in schema\r\n  }`;\r\n  const icons = await sanityClient.fetch(query);\r\n  return icons;\r\n}","// lib/fetchUser.ts\r\nimport sanityClient from '../../utils/sanity';\r\n\r\nexport const fetchImages = async (sortOption = 'default') => {\r\n  let orderClause = '';\r\n  switch (sortOption) {\r\n    case 'titleAsc':  orderClause = '| order(title asc)'; break;\r\n    case 'titleDesc': orderClause = '| order(title desc)'; break;\r\n    case 'dateAsc':   orderClause = '| order(_createdAt asc)'; break;\r\n    case 'dateDesc':  orderClause = '| order(_createdAt desc)'; break;\r\n  }\r\n\r\n  const query = `*[_type == \"imageAsset\"] ${orderClause} {\r\n    _id,\r\n    title,\r\n    description,\r\n    image1,         // keep full Sanity image object\r\n    image2,         // same\r\n    caption1,\r\n    alt1,\r\n    alt2,\r\n    iconName\r\n  }`;\r\n\r\n  try {\r\n    const data = await sanityClient.fetch(query);\r\n    return data; // pass raw; AppMedia will render responsively\r\n  } catch (error) {\r\n    console.error('Error fetching images', error);\r\n    return [];\r\n  }\r\n};\r\n","// src/dynamic-app/preload-dynamic-app.ts\r\nimport fetchSVGIcons from './lib/fetchSVGIcons';\r\nimport { fetchImages } from './lib/fetchUser';\r\n\r\nexport type Cache = { icons?: Record<string, string>; images?: any[] };\r\n\r\ntype IconLike = { title?: string; icon?: string; url?: string };\r\n\r\nlet cache: Cache = {};\r\nlet inFlight: Promise<Cache> | null = null;\r\n\r\nexport function getPreloadedDynamicApp(): Cache {\r\n  return cache;\r\n}\r\n\r\nexport function primeFromSSR(data?: Partial<Cache>) {\r\n  if (!data) return;\r\n  cache = { ...cache, ...data };\r\n}\r\n\r\nfunction toIconMap(list: IconLike[]): Record<string, string> {\r\n  return list.reduce((acc, it) => {\r\n    if (!it?.title) return acc;\r\n    const val = it.icon ?? it.url; // inline SVG takes precedence; else URL\r\n    if (typeof val === 'string' && val.length > 0) acc[it.title] = val;\r\n    return acc;\r\n  }, {} as Record<string, string>);\r\n}\r\n\r\n/** Wait for current preloading (if any), then return cache */\r\nexport async function whenDynamicPreloadReady(): Promise<Cache> {\r\n  if (cache.icons && cache.images) return cache;\r\n  if (inFlight) {\r\n    await inFlight;\r\n    return cache;\r\n  }\r\n  return cache;\r\n}\r\n\r\nexport async function ensureIconsPreload(): Promise<Record<string, string>> {\r\n  // If a full preloading is in-flight, wait for it instead of double-fetching\r\n  if (!cache.icons && inFlight) {\r\n    await inFlight;\r\n    return cache.icons || {};\r\n  }\r\n  if (cache.icons) return cache.icons;\r\n\r\n  let iconsRaw: unknown;\r\n  try {\r\n    iconsRaw = await fetchSVGIcons();\r\n  } catch {\r\n    iconsRaw = [];\r\n  }\r\n  const list = Array.isArray(iconsRaw) ? (iconsRaw as IconLike[]) : [];\r\n  const icons = toIconMap(list);\r\n  cache.icons = icons;\r\n  return icons;\r\n}\r\n\r\nexport async function ensureImagesPreload(): Promise<any[]> {\r\n  // If a full preloading is in-flight, wait for it instead of double-fetching\r\n  if (!cache.images && inFlight) {\r\n    await inFlight;\r\n    return cache.images || [];\r\n  }\r\n  if (cache.images) return cache.images;\r\n\r\n  let imagesRaw: unknown;\r\n  try {\r\n    imagesRaw = await fetchImages();\r\n  } catch {\r\n    imagesRaw = [];\r\n  }\r\n  const images = Array.isArray(imagesRaw) ? (imagesRaw as any[]) : [];\r\n  cache.images = images;\r\n  return images;\r\n}\r\n\r\n/** Convenience: ensure both icons + images (with in-flight dedupe) */\r\nexport async function ensureDynamicPreload(): Promise<Cache> {\r\n  if (cache.icons && cache.images) return cache;\r\n  if (inFlight) return inFlight;\r\n\r\n  inFlight = Promise.all([ensureIconsPreload(), ensureImagesPreload()])\r\n    .then(([icons, images]) => {\r\n      cache = { icons, images };\r\n      return cache;\r\n    })\r\n    .finally(() => {\r\n      inFlight = null;\r\n    });\r\n\r\n  return inFlight;\r\n}\r\n\r\n// Optional: hydrate from SSR\r\ndeclare global {\r\n  interface Window {\r\n    __DYNAMIC_PRELOAD__?: Cache;\r\n  }\r\n}\r\nif (typeof window !== 'undefined' && (window as any).__DYNAMIC_PRELOAD__) {\r\n  primeFromSSR((window as any).__DYNAMIC_PRELOAD__);\r\n}\r\n","","","import { useEffect, useState } from 'react';\r\n\r\nexport function useDynamicOverlay(frameRef: React.RefObject<HTMLElement>) {\r\n  const [style, setStyle] = useState<{\r\n    width: number;\r\n    heightSet1: number;\r\n    heightSet2: number;\r\n  }>({\r\n    width: 0,\r\n    heightSet1: 0,\r\n    heightSet2: 0,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const update = () => {\r\n      if (!frameRef.current) return;\r\n\r\n      const rect = frameRef.current.getBoundingClientRect();\r\n      const aspect = rect.width / rect.height;\r\n\r\n      // Aspect ratio breakpoints\r\n      const minAspect = 1.5 / 6.5; // ~0.2307\r\n      const maxAspect = 3.3 / 6.5; // ~0.5077\r\n\r\n      // Width range (shared)\r\n      const minWidth = 150;\r\n      const maxWidth = 320;\r\n\r\n      // Height range set 1 (your current svh-based values)\r\n      const minHeightSet1 = 63;\r\n      const maxHeightSet1 = 93;\r\n\r\n      // Height range set 2 (original px-based)\r\n      const minHeightSet2 = 280;\r\n      const maxHeightSet2 = 610;\r\n\r\n      // --- Aspect ratio-based lerp ---\r\n      let width: number;\r\n      let height1: number;\r\n      let height2: number;\r\n\r\n      if (aspect <= minAspect) {\r\n        width = minWidth;\r\n        height1 = minHeightSet1;\r\n        height2 = minHeightSet2;\r\n      } else if (aspect >= maxAspect) {\r\n        width = maxWidth;\r\n        height1 = maxHeightSet1;\r\n        height2 = maxHeightSet2;\r\n      } else {\r\n        const t = (aspect - minAspect) / (maxAspect - minAspect);\r\n        width = minWidth + (maxWidth - minWidth) * t;\r\n        height1 = minHeightSet1 + (maxHeightSet1 - minHeightSet1) * t;\r\n        height2 = minHeightSet2 + (maxHeightSet2 - minHeightSet2) * t;\r\n      }\r\n\r\n      // --- Absolute height multiplier (0 → 2 over 0–1300px) ---\r\n      const minFrameHeight = 0;\r\n      const maxFrameHeight = 1300;\r\n      const minMultiplier = 0;\r\n      const maxMultiplier = 2;\r\n\r\n      const clampedHeight = Math.min(Math.max(rect.height, minFrameHeight), maxFrameHeight);\r\n      const heightT = (clampedHeight - minFrameHeight) / (maxFrameHeight - minFrameHeight);\r\n      const heightMultiplier = minMultiplier + (maxMultiplier - minMultiplier) * heightT;\r\n\r\n      // Apply multiplier\r\n      width *= heightMultiplier;\r\n      height1 *= heightMultiplier;\r\n      height2 *= heightMultiplier;\r\n\r\n      setStyle({\r\n        width,\r\n        heightSet1: height1,\r\n        heightSet2: height2,\r\n      });\r\n    };\r\n\r\n    update();\r\n    window.addEventListener('resize', update);\r\n    window.addEventListener('orientationchange', update);\r\n    return () => {\r\n      window.removeEventListener('resize', update);\r\n      window.removeEventListener('orientationchange', update);\r\n    };\r\n  }, [frameRef]);\r\n\r\n  return style; // { width, heightSet1, heightSet2 }\r\n}\r\n","// useRealMobileViewport.ts\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport function useRealMobileViewport() {\r\n  const [isRealMobile, setIsRealMobile] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      const touch = navigator.maxTouchPoints > 0;\r\n      const coarse = window.matchMedia?.('(pointer: coarse)').matches ?? false;\r\n      const width = window.innerWidth;\r\n      const ua = navigator.userAgent || navigator.vendor || (window as any).opera;\r\n\r\n      // iOS detection (iPhone / iPad)\r\n      const isIOS = /iPad|iPhone|iPod/.test(ua) ||\r\n        (navigator.platform === 'MacIntel' && touch); // iPadOS pretends to be Mac\r\n\r\n      // Android detection\r\n      const isAndroid = /Android/.test(ua);\r\n\r\n      // Consider it real mobile if:\r\n      // - Touch exists, and viewport is small, or\r\n      // - Known mobile UA\r\n      const realMobile =\r\n        (touch && width <= 1024) ||\r\n        isIOS ||\r\n        isAndroid ||\r\n        coarse;\r\n\r\n      setIsRealMobile(realMobile);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    window.addEventListener('orientationchange', checkMobile);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', checkMobile);\r\n      window.removeEventListener('orientationchange', checkMobile);\r\n    };\r\n  }, []);\r\n\r\n  return isRealMobile;\r\n}\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport '../../styles/loading-hub.css';\r\n\r\ntype LoadingHubProps = {\r\n  keyword?: string;\r\n  lines?: string[];\r\n  /** Fixed height so layout doesn’t jump */\r\n  minHeight?: number | string;\r\n  /** Extra className to theme per block */\r\n  className?: string;\r\n  /** ARIA label for screen readers */\r\n  ariaLabel?: string;\r\n  /** Optional % if you fake/stream progress */\r\n  progress?: number | null;\r\n  /** Full cycle time per line (ms) */\r\n  cycleMs?: number;\r\n  /** Animation length inside that cycle (ms) */\r\n  animMs?: number;\r\n};\r\n\r\nexport default function LoadingHub({\r\n  keyword,\r\n  lines = ['Loading…'],\r\n  minHeight = 160,\r\n  className = '',\r\n  ariaLabel = 'Loading',\r\n  progress = null,\r\n  cycleMs = 1400,\r\n  animMs = 900,\r\n}: LoadingHubProps) {\r\n  const [lineIndex, setLineIndex] = useState(0);\r\n\r\n  // rotate through provided lines (no-op if only one)\r\n  const hasMultiple = lines.length > 1;\r\n  useEffect(() => {\r\n    if (!hasMultiple) return;\r\n    const t = setInterval(() => {\r\n      setLineIndex((i) => (i + 1) % lines.length);\r\n    }, cycleMs);\r\n    return () => clearInterval(t);\r\n  }, [hasMultiple, lines.length, cycleMs]);\r\n\r\n  // Avoid reflow: lock container height\r\n  const style = useMemo<React.CSSProperties>(() => {\r\n    const h = typeof minHeight === 'number' ? `${minHeight}px` : (minHeight ?? 'auto');\r\n    return { minHeight: h };\r\n  }, [minHeight]);\r\n\r\n  // SR-only progressive percent\r\n  const srRef = useRef<HTMLSpanElement>(null);\r\n  useEffect(() => {\r\n    if (progress == null || !srRef.current) return;\r\n    srRef.current.textContent = `${Math.round(progress)}%`;\r\n  }, [progress]);\r\n\r\n  return (\r\n    <div\r\n      className={`loading-hub loading-hub--text ${className || ''}`}\r\n      style={style}\r\n      role=\"status\"\r\n      aria-live=\"polite\"\r\n      aria-label={ariaLabel}\r\n      data-keyword={keyword || undefined}\r\n      // expose anim timing to CSS\r\n      data-anim-ms={animMs}\r\n    >\r\n      <div className=\"loading-hub__copy\" aria-hidden={false}>\r\n        {/* key forces re-mount so the animation restarts */}\r\n        <h2 key={lineIndex} className=\"loading-hub__line\">\r\n          {lines[lineIndex]}\r\n        </h2>\r\n\r\n        {progress != null && (\r\n          <div className=\"loading-hub__progress\" aria-hidden=\"true\">\r\n            {Math.round(progress)}%\r\n          </div>\r\n        )}\r\n\r\n        {/* SR-only percent, updates without layout */}\r\n        <span className=\"sr-only\" ref={srRef} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useRef","useState","client","useDynamicOverlay","useSsrData","useRealMobileViewport","LoadingHub","ensureDynamicPreload","urlFor","jsx","_jsx","jsxs","_jsxs","getDeviceType","w","Frame","ssrData","preloadedMap","preloaded","dynamic","svgMap","setSvgMap","device","setDevice","window","innerWidth","imgLoaded","setImgLoaded","fetchErr","setFetchErr","frameRef","overlaySize","isRealMobile","onResize","addEventListener","removeEventListener","Object","keys","length","fetch","then","results","map","forEach","r","title","toLowerCase","file","asset","url","catch","err","console","warn","svgUrl","img","current","Boolean","complete","warmedOnce","images","Array","isArray","WARM_COUNT","LQ_WIDTH","LQ_QUALITY","head","document","warmed","outer","it","candidates","image1","image2","filter","srcAsset","src","width","quality","auto","querySelector","link","createElement","rel","as","href","crossOrigin","setAttribute","appendChild","preImg","Image","decoding","className","children","ref","id","undefined","alt","loading","onLoad","onError","draggable","style","visibility","opacity","transition","height","heightSet1","heightSet2","keyword","lines","minHeight","sanityClient","fetchSVGIcons","query","icons","fetchImages","sortOption","orderClause","data","error","cache","inFlight","getPreloadedDynamicApp","primeFromSSR","toIconMap","list","reduce","acc","val","icon","whenDynamicPreloadReady","ensureIconsPreload","iconsRaw","ensureImagesPreload","imagesRaw","Promise","all","finally","__DYNAMIC_PRELOAD__","setStyle","update","rect","getBoundingClientRect","aspect","minAspect","maxAspect","minWidth","maxWidth","minHeightSet1","maxHeightSet1","minHeightSet2","maxHeightSet2","height1","height2","t","minFrameHeight","maxFrameHeight","minMultiplier","maxMultiplier","clampedHeight","Math","min","max","heightT","heightMultiplier","setIsRealMobile","checkMobile","touch","navigator","maxTouchPoints","coarse","matchMedia","matches","ua","userAgent","vendor","opera","isIOS","test","platform","isAndroid","realMobile","useMemo","ariaLabel","progress","cycleMs","animMs","lineIndex","setLineIndex","hasMultiple","setInterval","i","clearInterval","h","srRef","textContent","round","role"],"sourceRoot":""}